function HighscoreEntry(a,c,b){this.game=a;this.name="___________";this.i=0;this.charVal=65;this.maxLength=10;this.score=0;this.highscoreText=this.game.add.text(c,b,"Enter Your Name:\n"+" "+this.name,{font:"24px Impact",fill:"#f00"});this.highscoreText.anchor.set(0.5,0.5);this.highscoreText.fixedToCamera=true;this.highscoreText.visible=false;this.pressCooldown=250;this.pressTimer=0}HighscoreEntry.prototype.replaceStringAt=function(b,a){this.name=this.name.substr(0,b)+String.fromCharCode(a)+this.name.substr(b+1+name.length)};HighscoreEntry.prototype.incrementChar=function(){if(this.pressTimer>this.pressCooldown){this.charVal++;if(this.charVal>89){this.charVal=65}this.pressTimer=0}};HighscoreEntry.prototype.decrementChar=function(){if(this.pressTimer>this.pressCooldown){this.charVal--;if(this.charVal<65){this.charVal=89}this.pressTimer=0}};HighscoreEntry.prototype.incrementIndex=function(){if(this.pressTimer>this.pressCooldown){this.i++;if(this.i>this.maxLength){this.i=0}this.pressTimer=0}};HighscoreEntry.prototype.decrementIndex=function(){if(this.pressTimer>this.pressCooldown){this.i--;if(this.i<0){this.i=this.maxLength}this.pressTimer=0}};HighscoreEntry.prototype.updateVisibility=function(a){this.highscoreText.visible=a};HighscoreEntry.prototype.updateScore=function(a){this.score=a};HighscoreEntry.prototype.getName=function(){return this.name};HighscoreEntry.prototype.getScore=function(){return this.score};HighscoreEntry.prototype.update=function(){this.pressTimer+=this.game.time.elapsed;this.replaceStringAt(this.i,this.charVal);this.highscoreText.text="Enter Your Name:\n"+" "+this.name};HighscoreEntry.prototype.destroy=function(){this.highscoreText.destroy()};function HighscoreTable(a){this.scores=["","","","","","","","","",""];this.names=["","","","","","","","","",""];this.highscoreListText=[];this.game=a;this.createText()}HighscoreTable.prototype.add=function(b,f,a){this.scores[a]=f;this.names[a]=b;for(var d=1;d<this.scores.length;d++){for(var e=0;e<this.scores.length-1;e++){if(this.scores[d]>=this.scores[e]){var c=this.names[e];this.names[e]=this.names[d];this.names[d]=c;c=this.scores[e];this.scores[e]=this.scores[d];this.scores[d]=c}}}for(d=0;d<this.highscoreListText.length;d++){if(this.scores[d]){this.postHighscore(d)}}};HighscoreTable.prototype.getHighscoreTable=function(){var a=this;$.ajax({type:"GET",url:"https://aghighscore.appspot.com",async:true,contentType:"application/json",dataType:"jsonp",success:function(d){var c,b;for(c=0;c<d.length;c++){b=parseInt(d[c].position,10);a.scores[b]=parseInt(d[c].score,10);a.names[b]=d[c].playerName}}})};HighscoreTable.prototype.postHighscore=function(b){var a="https://aghighscore.appspot.com"+"/loc?name="+b+"&score="+this.scores[b]+"&playerName="+this.names[b];$.ajax({type:"GET",url:a,async:true,contentType:"application/json",dataType:"jsonp"})};HighscoreTable.prototype.isItAHighscore=function(a){if(this.scores[this.scores.length-1]==false){return true}else{if(a>this.scores[this.scores.length-1]){return true}}return false};HighscoreTable.prototype.createText=function(){for(var a=0;a<10;a++){this.highscoreListText[a]=this.game.add.text(this.game.world.width/2-150,100+(a*35),(a+1)+".  "+this.names[a]+" "+this.scores[a],{font:"24px Impact",fill:"#f00"});this.highscoreListText[a].anchor.set(0,0.5)}};function GameOverScreenState(a){this.isAHighscore=a;this.gameoverBackground=null;this.gameOverText=null;this.highscoreInfoText=null;this.enterScoreButton=null;this.replayButton=null;this.backToMenuButton=null}GameOverScreenState.prototype.create=function(a,b,c){this.gameoverBackground=a.add.sprite(a.world.width/2,a.world.height/2,"blankBackground");this.gameoverBackground.anchor.set(0.5,0.5);this.gameoverBackground.scale.x=0.5;this.gameoverBackground.scale.y=0.5;this.gameOverText=a.add.text((a.world.width/2),(a.world.height/2)-120,"Game Over",{font:"24px Impact",fill:"#f00"});this.gameOverText.anchor.set(0.5,0.5);this.highscoreInfoText=a.add.text((a.world.width/2),(a.world.height/2)-50,"",{font:"24px Impact",fill:"#f00"});this.highscoreInfoText.anchor.set(0.5,0.5);if(this.isAHighscore==true){this.highscoreInfoText.text="You have a highscore!"}else{this.highscoreInfoText.text="Sadly you don't have a highscore"}if(this.isAHighscore==true){this.enterScoreButton=a.add.sprite((a.world.width/2),(a.world.height/2),"enterScoreButton");this.enterScoreButton.inputEnabled=true;this.enterScoreButton.events.onInputDown.add(function(){b.stateSwitch(a,b.getGameOverScore(),c)},b);this.enterScoreButton.anchor.setTo(0.5,0.5);this.enterScoreButton.scale.x=0.75;this.enterScoreButton.scale.y=0.5}this.replayButton=a.add.sprite((a.world.width/2),(a.world.height/2)+50,"replayButton");this.replayButton.inputEnabled=true;this.replayButton.events.onInputDown.add(function(){c.reset();this.exit()},this);this.replayButton.anchor.setTo(0.5,0.5);this.replayButton.scale.x=0.75;this.replayButton.scale.y=0.5;this.backToMenuButton=a.add.sprite((a.world.width/2),(a.world.height/2)+100,"backToMenuButton");this.backToMenuButton.inputEnabled=true;this.backToMenuButton.events.onInputDown.add(function(){c.setPositions();a.state.start("Menu")},a);this.backToMenuButton.anchor.setTo(0.5,0.5);this.backToMenuButton.scale.x=0.75;this.backToMenuButton.scale.y=0.5};GameOverScreenState.prototype.exit=function(){this.gameOverText.destroy();this.highscoreInfoText.destroy();this.gameoverBackground.destroy();this.backToMenuButton.destroy();this.replayButton.destroy();if(this.isAHighscore){this.enterScoreButton.destroy()}};GameOverScreenState.prototype.update=function(a){};function GameOverScoreState(){this.highscore=null;this.gameoverBackground=null;this.congratulationsText=null;this.scoreDisplayText=null;this.doneButton=null}GameOverScoreState.prototype.create=function(b,c,d){this.gameoverBackground=b.add.tileSprite(b.world.width/2,b.world.height/2,400,300,"blankBackground");this.gameoverBackground.anchor.set(0.5,0.5);this.congratulationsText=b.add.text((b.world.width/2),(b.world.height/2)-100,"Congratulations \n on your highscore!",{font:"24px Impact",fill:"#f00"});this.congratulationsText.align="center";this.congratulationsText.anchor.set(0.5,0.5);this.scoreDisplayText=b.add.text((b.world.width/2),(b.world.height/2)-20,"Score: "+d.player.getScore(),{font:"24px Impact",fill:"#f00"});this.scoreDisplayText.anchor.set(0.5,0.5);this.highscore=new HighscoreEntry(b,(b.world.width/2),(b.world.height/2)+40);this.highscore.updateVisibility(true);this.highscore.updateScore(d.player.getScore());var a=this;this.doneButton=b.add.sprite((b.world.width/2),(b.world.height/2)+100,"doneButton");this.doneButton.inputEnabled=true;this.doneButton.events.onInputDown.add(function(){GameState.highscoreTable.add(a.highscore.getName(),a.highscore.getScore(),9);d.setPositions();b.state.start("Menu")},b);this.doneButton.anchor.setTo(0.5,0.5);this.doneButton.scale.x=0.75;this.doneButton.scale.y=0.5};GameOverScoreState.prototype.exit=function(){this.doneButton.destroy();this.gameoverBackground.destroy();this.scoreDisplayText.destroy();this.congratulationsText.destroy();this.highscore.destroy()};GameOverScoreState.prototype.update=function(a){if(a.input.activePointer.isDown){if(a.input.activePointer.worldX>550){this.highscore.incrementIndex()}if(a.input.activePointer.worldX<350){this.highscore.decrementIndex()}if(a.input.activePointer.worldY>400){this.highscore.decrementChar()}if(a.input.activePointer.worldY<200){this.highscore.incrementChar()}}this.highscore.update()};function GameOverStateManager(){this.currentState=null;this.goodGameOverScreen=new GameOverScreenState(true);this.gameOverScore=new GameOverScoreState();this.badGameOverScreen=new GameOverScreenState(false)}GameOverStateManager.prototype.getGameOverScore=function(){return this.gameOverScore};GameOverStateManager.prototype.getGoodGameOverScreen=function(){return this.goodGameOverScreen};GameOverStateManager.prototype.getBadGameOverScreen=function(){return this.badGameOverScreen};GameOverStateManager.prototype.stateSwitch=function(a,c,b){if(this.currentState!=null){this.currentState.exit()}this.currentState=c;this.currentState.create(a,this,b)};GameOverStateManager.prototype.update=function(a){this.currentState.update(a)};function WorldObject(b,a,h,e,c,g,j,f,d){this.game=j;this.worldObject=f.create(b,a,g);this.worldObject.scale.x=h;this.worldObject.scale.y=e;this.worldObject.angle=c;this.worldObject.anchor.set(0.5);this.game.physics.enable(this.worldObject,Phaser.Physics.ARCADE);this.worldObject.body.immovable=true;this.worldObject.body.checkCollision.left=d;this.worldObject.body.collideWorldBounds=false}function RunnerPC(b,a,j,h,c,l,g,d,e,f,k){this.game=k;this.character=this.game.add.sprite(b,a,e);this.character.animations.add("run");this.character.animations.play("run",f,true);this.character.scale.x=j;this.character.scale.y=h;this.character.angle=c;this.character.anchor.set(0.5);this.game.physics.enable(this.character,Phaser.Physics.ARCADE);this.character.body.moves=false;this.character.body.collideWorldBounds=true;this.boostVelocityX=d;this.runVelocityX=g;this.velocityX=this.runVelocityX;this.velocityY=l;this.game.camera.follow(this.character,this.game.camera.FOLLOW_PLATFORMER);this.inversionTimer=0;this.inversionCooldown=200;this.score=0;this.onFloor=false;this.boostCooldownTimer=0;this.boostCooldown=1000;this.boostActivationTimer=0;this.boostActivationPeriod=500;this.boostActive=false}RunnerPC.prototype.getScore=function(){return Math.round(this.score)};RunnerPC.prototype.getPositionX=function(){return this.character.position.x};RunnerPC.prototype.getScaleX=function(){return this.character.scale.x};RunnerPC.prototype.getRotation=function(){return this.character.angle};RunnerPC.prototype.getPositionY=function(){return this.character.position.y};RunnerPC.prototype.updateScore=function(a){this.score=a};RunnerPC.prototype.updateOnFloor=function(a){this.onFloor=a};RunnerPC.prototype.separate=function(a,b){if(a.position.y<b.position.y&&(a.position.y+a.height/2)>((b.position.y-b.height/2)+1)){a.position.y=a.position.y+(1-((a.position.y+a.height/2)-(b.position.y-b.height/2)))}else{if(a.position.y>b.position.y&&(a.position.y-a.height/2)<((b.position.y+b.height/2)-1)){a.position.y=a.position.y-(1+((a.position.y-a.height/2)-(b.position.y+b.height/2)))}}};RunnerPC.prototype.invertGravity=function(){if(this.inversionTimer>this.inversionCooldown&&this.onFloor==true){this.velocityY=-this.velocityY;this.character.position.y+=this.velocityY*2;this.inversionTimer=0;this.character.scale.x*=-1;this.character.angle-=180}};RunnerPC.prototype.boost=function(){if(this.boostCooldownTimer>this.boostCooldown){this.boostActive=true;this.boostCooldownTimer=0}};RunnerPC.prototype.reset=function(){this.boostActive=false;this.character.angle=0;this.score=0;this.velocityX=this.runVelocityX;this.character.scale.x=1;this.boostActivationTimer=0;this.inversionTimer=0;this.velocityY=10;this.character.position.y=434};RunnerPC.prototype.getVelocityX=function(){return this.velocityX};RunnerPC.prototype.update=function(){if(this.onFloor==false&&this.boostActive==false){this.character.position.y+=this.velocityY}var a=this.game.time.elapsed;this.inversionTimer+=a;this.score+=this.velocityX*(1/1000*a);if(this.boostActive==false){this.boostCooldownTimer+=a}else{this.boostActivationTimer+=a}if(this.boostActive==true&&this.boostActivationTimer<this.boostActivationPeriod){this.velocityX=this.boostVelocityX}else{this.boostActive=false;this.boostActivationTimer=0;this.velocityX=this.runVelocityX}};function GameWorldManager(k,j,a,g,e,d,f,h,l,m,b,c){this.game=k;this.obstacles=null;this.walls=null;this.platforms=null;this.floorAndRoof=null;this.spaceBetweenWalls=j;this.platformWidth=a;this.wallHalfWidth=g;this.obstacleWidth=e;this.floorWidth=d;this.wallCount=f;this.doubleWalls=h;this.platformCount=l;this.platformPerRoom=m;this.obstacleCount=b;this.obstaclesPerRoom=c;this.wallPositions=this.wallRandomizer(80,400);this.platformPositions=this.platformRandomizer(100,400);this.obstaclePositions=this.obstacleRandomizer(30,448);this.floorAndRoofPositions=this.floorAndRoofPlacement(480);this.obstaclesIterator=0;this.wallIterator=2;this.platformIterator=0}GameWorldManager.prototype.create=function(){this.obstacles=game.add.group();for(var a=0;a<this.obstaclePositions.length;a++){new WorldObject(this.obstaclePositions[a][0],this.obstaclePositions[a][1],1,1,this.obstaclePositions[a][2],"spikes",game,this.obstacles,true)}this.platforms=game.add.group();for(a=0;a<this.platformPositions.length;a++){new WorldObject(this.platformPositions[a][0],this.platformPositions[a][1],1,1,0,"platformMetal",game,this.platforms,false)}this.walls=game.add.group();for(a=0;a<this.wallPositions.length;a++){new WorldObject(this.wallPositions[a][0],this.wallPositions[a][1],1,1,0,"wall",game,this.walls,true)}this.floorAndRoof=game.add.group();for(a=0;a<this.floorAndRoofPositions.length;a++){new WorldObject(this.floorAndRoofPositions[a][0],this.floorAndRoofPositions[a][1],1,1,0,"platform",game,this.floorAndRoof,true)}};GameWorldManager.prototype.getWallGroup=function(){return this.walls};GameWorldManager.prototype.getPlatformsGroup=function(){return this.platforms};GameWorldManager.prototype.getObstaclesGroup=function(){return this.obstacles};GameWorldManager.prototype.getFloorAndRoofGroup=function(){return this.floorAndRoof};GameWorldManager.prototype.freezeWorld=function(){for(i=0;i<this.platforms.length;i++){current=this.platforms.getAt(i);current.body.velocity.x=0}for(i=0;i<this.obstacles.length;i++){current=this.obstacles.getAt(i);current.body.velocity.x=0}for(i=0;i<this.walls.length;i++){current=this.walls.getAt(i);current.body.velocity.x=0}for(i=0;i<this.floorAndRoof.length;i++){current=this.floorAndRoof.getAt(i);current.body.velocity.x=0}};GameWorldManager.prototype.reset=function(){this.walls.destroy(true);this.platforms.destroy(true);this.obstacles.destroy(true);this.floorAndRoof.destroy(true);this.wallPositions=this.wallRandomizer(80,400);this.platformPositions=this.platformRandomizer(100,400);this.obstaclePositions=this.obstacleRandomizer(30,448);this.floorAndRoofPositions=this.floorAndRoofPlacement(480);this.create()};GameWorldManager.prototype.update=function(e){for(var c=0;c<this.obstacles.length;c++){var h=this.obstacles.getAt(c);if(h.position.x<=-80){var b,g;g=this.walls.getAt(this.wallIterator).position.x+this.obstacleWidth+Math.floor(this.obstaclesIterator/2)*this.spaceBetweenWalls/(this.obstaclesPerRoom/2);b=g+(this.spaceBetweenWalls/this.obstaclesPerRoom)-(this.obstacleWidth+this.wallHalfWidth);this.obstaclesIterator++;if(this.obstaclesIterator>=this.obstaclesPerRoom){this.obstaclesIterator=0}h.position.x=game.rnd.integerInRange(g,b)}h.body.velocity.x=-e}var f=this.wallHalfWidth+(this.platformWidth/2);for(c=0;c<this.platforms.length;c++){h=this.platforms.getAt(c);if(h.position.x<=-80){g=this.walls.getAt(this.wallIterator).position.x+f+(this.platformIterator*this.spaceBetweenWalls/this.platformPerRoom);b=g+(800-((f*2)+((this.platformWidth/2)*((this.platformPerRoom*2)-2))))/this.platformPerRoom;this.platformIterator++;if(this.platformIterator>=this.platformPerRoom){this.platformIterator=0}h.position.x=game.rnd.integerInRange(g,b);h.position.y=game.rnd.integerInRange(100,400)}h.body.velocity.x=-e}for(c=0;c<this.walls.length-1;c++){h=this.walls.getAt(c);var a=this.walls.getAt(3);if(h.position.x<=-80){h.position.x=this.spaceBetweenWalls*(this.wallCount-this.doubleWalls);this.wallIterator=c;if(game.rnd.integerInRange(1,1000)%2==0){h.position.y=80}else{h.position.y=400}if(a.position.x<=-80&&game.rnd.integerInRange(1,1000)%2==0){a.position.x=h.position.x;if(h.position.y==80){a.position.y=400}else{a.position.y=80}}}h.body.velocity.x=-e;a.body.velocity.x=-e}for(c=0;c<this.floorAndRoof.length;c++){h=this.floorAndRoof.getAt(c);if(h.position.x<=-80){var d;if(c!=0&&c!=this.floorAndRoof.length/2){d=this.floorAndRoof.getAt(c-1)}else{if(c<this.floorAndRoof.length/2){d=this.floorAndRoof.getAt(this.floorAndRoof.length/2-1)}else{d=this.floorAndRoof.getAt(this.floorAndRoof.length-1)}}h.position.x=d.position.x+d.width}h.body.velocity.x=-e}};GameWorldManager.prototype.platformRandomizer=function(d,e){var a=[];var g=this.wallHalfWidth+(this.platformWidth/2);for(var c=0;c<this.platformCount;c++){var f=this.spaceBetweenWalls+g+(c*this.spaceBetweenWalls/this.platformPerRoom);var b=f+(this.spaceBetweenWalls-((g*2)+((this.platformWidth/2)*((this.platformPerRoom*2)-2))))/this.platformPerRoom;a[c]=[];a[c][0]=this.game.rnd.integerInRange(f,b);a[c][1]=this.game.rnd.integerInRange(d,e)}return a};GameWorldManager.prototype.obstacleRandomizer=function(g,a){var h=[];var j=0;var d=this.wallHalfWidth+(this.obstacleWidth/2);for(var c=0;c<2;c++){for(var e=0;e<this.obstacleCount/2;e++){var b=this.spaceBetweenWalls+d+(e*this.spaceBetweenWalls/(this.obstaclesPerRoom/2));var f=b+(this.spaceBetweenWalls/this.obstaclesPerRoom)-(this.obstacleWidth+this.wallHalfWidth);h[j]=[];h[j][0]=this.game.rnd.integerInRange(b,f);if(c==0){h[j][1]=g;h[j][2]=180}else{h[j][1]=a;h[j][2]=0}j++}}return h};GameWorldManager.prototype.wallRandomizer=function(a,c){positions=[];for(i=0;i<this.wallCount;i++){positions[i]=[];if(i<this.wallCount-this.doubleWalls){positions[i][0]=800+(i*this.spaceBetweenWalls);if(game.rnd.integerInRange(1,1000)%2==0){positions[i][1]=a}else{positions[i][1]=c}}else{var b=(this.game.rnd.integerInRange(1,1000)%(this.wallCount-this.doubleWalls));positions[i][0]=800+(b*this.spaceBetweenWalls);if(positions[b][1]==400){positions[i][1]=a}else{positions[i][1]=c}}}return positions};GameWorldManager.prototype.floorAndRoofPlacement=function(b){var a=[];var c=0;for(i2=1;i2>-1;i2--){for(i=1;i<10;i++){a[c]=[];a[c][0]=(i*this.floorWidth)-this.floorWidth/2;a[c][1]=i2*b;c++}}return a};var GameState={backgroundScrollX:null,playerPosition:null,highscoreTable:null,gameWorld:null};GameState.Highscores=function(){this.background=null;this.obstacles=null;this.randomPlatforms=null;this.floorAndRoof=null;this.randomWalls=null;this.player=null;this.highscoreBackground=null;this.highscoreTitleText=null;this.backButton=null};GameState.Highscores.prototype={create:function(){this.background=game.add.tileSprite(0,0,game.world.width,game.world.height,"background");this.background.tilePosition.x=GameState.backgroundScrollX;GameState.gameWorld.create(game);this.player=new RunnerPC(GameState.playerPosition[0],GameState.playerPosition[1],GameState.playerPosition[2],1,GameState.playerPosition[3],10,100,500,"character",48,game);this.highscoreBackground=game.add.tileSprite(game.world.width/2,game.world.height/2-75,300,400,"blankBackground");this.highscoreBackground.anchor.set(0.5,0.5);this.highscoreTitleText=game.add.text((game.world.width/2),(game.world.height/2)-260,"Highscore",{font:"24px Impact",fill:"#aaa"});this.highscoreTitleText.anchor.set(0.5,0.5);this.backButton=this.add.button(400,475,"backButtonSpriteSheet",this.enterMainMenu,this,1,0,0,0);this.backButton.anchor.setTo(0.5,0.5);GameState.highscoreTable.createText()},enterMainMenu:function(){game.state.start("Menu")}};GameState.Tutorial=function(){this.background=null;this.obstacles=null;this.randomPlatforms=null;this.floorAndRoof=null;this.randomWalls=null;this.player=null;this.backButton=null;this.tutorialImage=null};GameState.Tutorial.prototype={create:function(){this.background=this.game.add.tileSprite(0,0,this.game.world.width,this.game.world.height,"background");this.background.tilePosition.x=GameState.backgroundScrollX;GameState.gameWorld.create(game);this.player=new RunnerPC(GameState.playerPosition[0],GameState.playerPosition[1],GameState.playerPosition[2],1,GameState.playerPosition[3],10,100,500,"character",48,game);this.backButton=this.add.button(400,550,"backButtonSpriteSheet",this.enterMainMenu,this,1,0,0,0);this.backButton.anchor.setTo(0.5,0.5);this.tutorialImage=this.game.add.sprite(400,300,"tutorialDisplay");this.tutorialImage.anchor.set(0.5,0.5)},enterMainMenu:function(){this.game.state.start("Menu")}};GameState.Game=function(){this.player=null;this.background=null;this.inversionKey=null;this.boostKey=null;this.boostButton=null;this.invertButton=null;this.scoreText=null;this.gameOverState=null;this.gameOver=false;this.gameStop=false;this.resetTimer=110};GameState.Game.prototype={create:function(){this.background=game.add.tileSprite(0,0,game.world.width,game.world.height,"background");this.player=new RunnerPC(GameState.playerPosition[0],GameState.playerPosition[1],GameState.playerPosition[2],1,GameState.playerPosition[3],10,100,500,"character",48,game);GameState.gameWorld.create(game);this.inversionKey=game.input.keyboard.addKey(Phaser.Keyboard.W);this.boostKey=game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);this.boostButton=this.add.button(game.world.width-730,game.world.height-35,"boostButton",this.player.boost,this.player,0,0,0,0);this.boostButton.anchor.setTo(0.5,0.5);this.boostButton.scale.x=1.5;this.boostButton.scale.y=1.5;this.boostButton.fixedToCamera=true;this.invertButton=this.add.button(game.world.width-70,game.world.height-35,"invertGravityButton",this.player.invertGravity,this.player,0,0,0,0);this.invertButton.anchor.setTo(0.5,0.5);this.invertButton.scale.x=1.5;this.invertButton.scale.y=1.5;this.invertButton.fixedToCamera=true;this.scoreText=game.add.text(game.world.width/2,game.world.height-35,"Score "+this.player.getScore(),{font:"24px Impact",fill:"#f00"});this.scoreText.anchor.set(0.5,0.5);this.scoreText.fixedToCamera=true;this.gameOverState=new GameOverStateManager();if(this.gameOver==true||this.gameStop==true){this.reset()}},update:function(){if(this.gameOver==false){this.player.update();this.background.tilePosition.x-=0.2;GameState.gameWorld.update(this.player.getVelocityX());if(this.inversionKey.isDown){this.player.invertGravity()}if(this.boostKey.isDown){this.player.boost()}if(game.physics.arcade.collide(this.player.character,GameState.gameWorld.getFloorAndRoofGroup(),this.player.separate,null,this.player)||game.physics.arcade.collide(this.player.character,GameState.gameWorld.getPlatformsGroup(),this.player.separate,null,this.player)){this.player.updateOnFloor(true)}else{this.player.updateOnFloor(false)}if(game.physics.arcade.collide(this.player.character,GameState.gameWorld.getWallGroup())||game.physics.arcade.collide(this.player.character,GameState.gameWorld.getObstaclesGroup())&&this.resetTimer>100){this.gameOver=true}if(this.resetTimer<100){this.resetTimer+=game.time.elapsed}this.scoreText.text="Score "+this.player.getScore()}else{if(this.gameStop==false){if(GameState.highscoreTable.isItAHighscore(this.player.getScore())){this.gameOverState.stateSwitch(game,this.gameOverState.getGoodGameOverScreen(),this)}else{this.gameOverState.stateSwitch(game,this.gameOverState.getBadGameOverScreen(),this)}GameState.gameWorld.freezeWorld();this.gameStop=true}this.gameOverState.update(game)}},reset:function(){this.player.reset();GameState.gameWorld.reset();this.background.tilePosition.x=0;this.resetTimer=0;this.gameOver=false;this.gameStop=false},setPositions:function(){GameState.playerPosition[0]=this.player.getPositionX();GameState.playerPosition[1]=this.player.getPositionY();GameState.playerPosition[2]=this.player.getScaleX();GameState.playerPosition[3]=this.player.getRotation();GameState.backgroundScrollX=this.background.tilePosition.x}};GameState.MainMenu=function(){this.background=null;this.obstacles=null;this.randomPlatforms=null;this.floorAndRoof=null;this.randomWalls=null;this.player=null;this.playButton=null;this.tutorialButton=null;this.highscoresButton=null;this.title=null};GameState.MainMenu.prototype={create:function(){this.background=game.add.tileSprite(0,0,game.world.width,game.world.height,"background");this.background.tilePosition.x=GameState.backgroundScrollX;if(this.music==null){this.music=game.add.audio("soundtrack")}if(this.music!=null&&!this.music.isPlaying){this.music.play();this.music.loop=true}GameState.gameWorld.create(game);this.player=new RunnerPC(GameState.playerPosition[0],GameState.playerPosition[1],GameState.playerPosition[2],1,GameState.playerPosition[3],10,100,500,"character",48,game);this.playButton=this.add.button(game.world.centerX-60,game.world.centerY,"playButtonSpriteSheet",this.enterGameState,this,1,0,0,0);this.playButton.anchor.setTo(0.5,0.5);this.tutorialButton=this.add.button(game.world.centerX,game.world.centerY+60,"tutorialButtonSpriteSheet",this.enterTutorialState,this,1,0,0,0);this.tutorialButton.anchor.setTo(0.5,0.5);this.highscoresButton=this.add.button(game.world.centerX+60,game.world.centerY,"highscoresButtonSpriteSheet",this.enterHighscoresState,this,1,0,0,0);this.highscoresButton.anchor.setTo(0.5,0.5);this.title=game.add.text((game.world.width/2),(game.world.height/2)-120,"The \n Inversioning",{font:"32px Impact",fill:"#f00"});this.title.align="center";this.title.anchor.set(0.5,0.5)},enterGameState:function(){game.state.start("Game")},enterTutorialState:function(){game.state.start("Tutorial")},enterHighscoresState:function(){game.state.start("Highscores")}};GameState.Init=function(){game.state.add("Menu",GameState.MainMenu);game.state.add("Game",GameState.Game);game.state.add("Tutorial",GameState.Tutorial);game.state.add("Highscores",GameState.Highscores)};GameState.Init.prototype={preload:function(){game.load.audio("soundtrack","src/audio/Cut and Run.ogg");game.load.image("boostButton","src/images/boostButton.png");game.load.image("invertGravityButton","src/images/invertGravityButton.png");game.load.image("tutorialDisplay","src/images/tutorial.png");game.load.image("platform","src/images/platform.png");game.load.image("platformMetal","src/images/platformMetal.png");game.load.image("background","src/images/Background.jpg");game.load.image("spikes","src/images/spikes.png");game.load.image("blankBackground","src/images/blankBackground.png");game.load.image("enterScoreButton","src/images/enterHighscore.png");game.load.image("backToMenuButton","src/images/backToMenu.png");game.load.image("doneButton","src/images/doneButton.png");game.load.image("replayButton","src/images/replay.png");game.load.image("wall","src/images/wall.png");game.load.spritesheet("playButtonSpriteSheet","src/images/playButtonSpriteSheet.png",100,50,2);game.load.spritesheet("tutorialButtonSpriteSheet","src/images/tutorialButtonSpriteSheet.png",100,50,2);game.load.spritesheet("highscoresButtonSpriteSheet","src/images/highscoresButtonSpriteSheet.png",100,50,2);game.load.spritesheet("backButtonSpriteSheet","src/images/backButtonSpriteSheet.png",100,50,2);game.load.spritesheet("character","src/images/bluesprite.png",35,60,24)},create:function(){game.input.maxPointers=2;game.input.addPointer();game.input.addPointer();if(game.device.desktop){game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL;game.scale.minWidth=480;game.scale.minHeight=260;game.scale.maxWidth=1024;game.scale.maxHeight=768;game.scale.pageAlignHorizontally=true;game.scale.pageAlignVertically=true;game.scale.setScreenSize(true)}else{game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL;game.scale.minWidth=480;game.scale.minHeight=260;game.scale.maxWidth=1024;game.scale.maxHeight=768;game.scale.pageAlignHorizontally=true;game.scale.pageAlignVertically=true;game.scale.forceOrientation(true,false);game.scale.setScreenSize(true);game.scale.refresh()}GameState.gameWorld=new GameWorldManager(game,800,128,16,32,160,4,1,9,3,24,8);GameState.backgroundScrollX=0;GameState.playerPosition=[];GameState.playerPosition[0]=450;GameState.playerPosition[1]=434;GameState.playerPosition[2]=1;GameState.playerPosition[3]=0;GameState.highscoreTable=new HighscoreTable(game);GameState.highscoreTable.getHighscoreTable();game.state.start("Menu")}};var game=new Phaser.Game(800,640,"The Inversioning");window.onload=function(){game.state.add("Init",GameState.Init);game.state.start("Init")};